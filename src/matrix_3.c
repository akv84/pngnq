#include "matrix_3.h"

double m3_det(matrix_3 m){
    return(m[0]*m[4]*m[8] 
         + m[1]*m[5]*m[6] 
         + m[2]*m[3]*m[7] 
         - m[0]*m[5]*m[7] 
         - m[1]*m[3]*m[8] 
         - m[2]*m[4]*m[6]);
}

void m3_invert(matrix_3 m, matrix_3 i){
    
    double d = m3_det(m);
    
    i[0] = (m[4]*m[8]-m[5]*m[7])/d;
    i[1] = (m[2]*m[7]-m[1]*m[8])/d;
    i[2] = (m[1]*m[5]-m[2]*m[4])/d;  
    i[3] = (m[5]*m[6]-m[3]*m[8])/d;  
    i[4] = (m[0]*m[8]-m[2]*m[6])/d;  
    i[5] = (m[2]*m[3]-m[0]*m[5])/d;  
    i[6] = (m[3]*m[7]-m[4]*m[6])/d;  
    i[7] = (m[6]*m[1]-m[0]*m[7])/d;
    i[8] = (m[0]*m[4]-m[1]*m[3])/d;
    
}   

void m3_multiply(matrix_3 a, matrix_3 b, matrix_3 c){
    c[0] = a[0]*b[0]+a[1]*b[3]+a[2]*b[6];
    c[1] = a[0]*b[1]+a[1]*b[4]+a[2]*b[7];
    c[2] = a[0]*b[2]+a[1]*b[5]+a[2]*b[8];
    c[3] = a[3]*b[0]+a[4]*b[3]+a[5]*b[6];
    c[4] = a[3]*b[1]+a[4]*b[4]+a[5]*b[7];
    c[5] = a[3]*b[2]+a[4]*b[5]+a[5]*b[8];
    c[6] = a[6]*b[0]+a[7]*b[3]+a[8]*b[6];
    c[7] = a[6]*b[1]+a[7]*b[4]+a[8]*b[7];
    c[8] = a[6]*b[2]+a[7]*b[5]+a[8]*b[8];
} 

